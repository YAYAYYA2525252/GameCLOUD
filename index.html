<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameCloud</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg: #050505; --sidebar: #0f0f0f; --card-bg: #111111; --border: #1f1f1f;
            --accent: #ffffff; --dim: #666; --text: #ffffff; --hero-grad: linear-gradient(45deg, #0f0f0f, #111111);
        }
        /* --- Themes --- */
        body.theme-oled { --bg: #050505; --sidebar: #000; --card-bg: #0a0a0a; --border: #111; }
        body.theme-graphite { --bg: #1a1c1e; --sidebar: #131416; --card-bg: #25282c; --border: #333; }
        body.theme-snow { --bg: #f5f5f7; --sidebar: #ffffff; --card-bg: #ffffff; --border: #e0e0e0; --text: #000; --accent: #000; --dim: #888; --hero-grad: linear-gradient(45deg, #eee, #fff); }
        body.theme-ocean { --bg: #001219; --sidebar: #001f29; --card-bg: #002d3a; --border: #005f73; --hero-grad: linear-gradient(135deg, #005f73, #0a9396); }
        body.theme-sunset { --bg: #2b0d0d; --sidebar: #3d1414; --card-bg: #4e1a1a; --border: #9b2226; --hero-grad: linear-gradient(135deg, #ae2012, #ee9b00); }
        body.theme-midnight { --bg: #0f0c29; --sidebar: #0b0920; --card-bg: #1f1b4d; --border: #302b63; --hero-grad: linear-gradient(135deg, #24243e, #302b63); }
        body.theme-frost { --bg: #e0f7fa; --sidebar: #b2ebf2; --card-bg: #ffffff; --border: #80deea; --text: #006064; --accent: #00bcd4; --hero-grad: linear-gradient(135deg, #80deea, #e0f7fa); }
        body.theme-lava { --bg: #200101; --sidebar: #100000; --card-bg: #300000; --border: #600000; --text: #ff4e00; --accent: #ff0000; --hero-grad: linear-gradient(135deg, #800000, #ff4e00); }
        body.theme-emerald { --bg: #061a10; --sidebar: #04120b; --card-bg: #0c2d1c; --border: #1b4d3e; --hero-grad: linear-gradient(135deg, #1b4d3e, #2ecc71); }
        body.theme-grape { --bg: #12001a; --sidebar: #0a000f; --card-bg: #240033; --border: #4b0082; --hero-grad: linear-gradient(135deg, #4b0082, #9b30ff); }

        body { font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); margin: 0; display: flex; height: 100vh; transition: 0.3s ease; overflow: hidden; }

        /* Clean Startup Screen */
        #boot-screen { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease; }
        .boot-logo { font-size: 2.5rem; font-weight: 900; letter-spacing: -2px; color: #fff; }

        nav { width: 240px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 30px 20px; flex-shrink: 0; }
        .brand { font-size: 1.5rem; font-weight: 800; margin-bottom: 40px; letter-spacing: -1px; }
        .nav-group { margin-bottom: 30px; }
        .nav-label { font-size: 0.7rem; color: var(--dim); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; display: block; }
        .nav-item { padding: 12px 15px; border-radius: 8px; color: var(--dim); cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 12px; margin-bottom: 5px; }
        .nav-item:hover, .nav-item.active { background: var(--card-bg); color: var(--text); }
        .nav-item.active { border-left: 3px solid var(--accent); border-radius: 0 8px 8px 0; }

        .sidebar-footer { margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border); }
        #clock { font-size: 2rem; font-weight: 800; color: var(--text); display: block; letter-spacing: -1px; }
        #date { font-size: 0.75rem; color: var(--dim); font-weight: 700; text-transform: uppercase; }

        main { flex-grow: 1; overflow-y: auto; padding: 40px; position: relative; }
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .search-input { background: var(--card-bg); border: 1px solid var(--border); padding: 10px 15px; border-radius: 8px; color: var(--text); outline: none; width: 250px; }

        .hero { background: var(--hero-grad); border: 1px solid var(--border); border-radius: 20px; padding: 40px; margin-bottom: 40px; position: relative; overflow: hidden; }
        .hero-content { position: relative; z-index: 2; }
        
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 20px; }
        .game-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 18px; padding: 20px 10px; display: flex; flex-direction: column; align-items: center; transition: 0.3s; cursor: pointer; text-align: center; position: relative; }
        .game-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        
        .icon-wrapper { width: 74px; height: 74px; border-radius: 18px; margin-bottom: 12px; overflow: hidden; }
        .game-icon-sq { width: 100%; height: 100%; object-fit: cover; }

        .game-card strong { font-size: 0.85rem; display: block; width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .card-actions { 
            margin-top: 10px; 
            display: flex; 
            gap: 15px; 
            font-size: 0.85rem; 
            color: var(--dim); 
            opacity: 0; 
            transform: translateY(5px);
            transition: 0.2s ease-in-out;
        }
        .game-card:hover .card-actions { 
            opacity: 1; 
            transform: translateY(0);
        }
        .card-actions i:hover { color: var(--text); }

        #settings-overlay, #modal-overlay, #edit-overlay, #split-selector-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 5000; backdrop-filter: blur(10px); }
        .modal-card { background: var(--bg); border: 1px solid var(--border); width: 400px; padding: 30px; border-radius: 24px; max-height: 80vh; overflow-y: auto; }
        input { width: 100%; margin-bottom: 12px; padding: 14px; background: var(--sidebar); border: 1px solid var(--border); color: var(--text); border-radius: 10px; box-sizing: border-box; outline: none; }
        
        .theme-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        .theme-btn { border: 1px solid var(--border); padding: 15px 5px; border-radius: 10px; cursor: pointer; font-size: 0.7rem; text-align: center; font-weight: bold; color: #fff; }

        #player-view { position: fixed; inset: 0; background: #000; display: none; z-index: 4000; flex-direction: column; }
        .player-controls { display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; background: #000; border-bottom: 1px solid #111; }
        .exit-btn { background: #fff; color: #000; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
        .split-btn { background: #222; color: #fff; border: 1px solid #333; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.8rem; }
        
        .frames-container { display: flex; flex-grow: 1; width: 100%; height: 100%; overflow: hidden; }
        iframe { flex: 1; border: none; height: 100%; }
        #game-frame-2 { display: none; border-left: 2px solid #111; }

        .split-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }
        .split-choice { background: var(--card-bg); border: 1px solid var(--border); padding: 15px; border-radius: 12px; display: flex; align-items: center; gap: 10px; cursor: pointer; }
        .split-choice:hover { border-color: var(--accent); }
        .split-choice img { width: 30px; height: 30px; border-radius: 5px; }
    </style>
</head>
<body class="theme-oled">

    <div id="boot-screen">
        <div class="boot-logo">GameCloud.</div>
    </div>

    <nav>
        <div class="brand">GameCloud.</div>
        <div class="nav-group">
            <span class="nav-label">Library</span>
            <div class="nav-item active" onclick="switchTab('home', this)"><i class="fa-solid fa-user"></i> Me</div>
            <div class="nav-item" onclick="switchTab('favs', this)"><i class="fa-solid fa-heart"></i> Favorites</div>
        </div>
        <div class="nav-group">
            <span class="nav-label">Manage</span>
            <div class="nav-item" onclick="toggleSettings()"><i class="fa-solid fa-gear"></i> Settings</div>
        </div>
        <div class="sidebar-footer">
            <div id="date">-- --- ----</div>
            <div id="clock">00:00</div>
        </div>
    </nav>

    <main>
        <div class="top-bar">
            <h2 id="view-title">Me</h2>
            <input type="text" class="search-input" id="searchBox" placeholder="Search..." oninput="render()">
        </div>
        
        <div class="hero">
            <div class="hero-content">
                <h1>Ready to play?</h1>
                <p>Your minimalist game collection, simplified into icons.</p>
                <button style="background:#fff; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:bold" onclick="openModal()">+ Add New</button>
            </div>
        </div>

        <div id="game-grid" class="game-grid"></div>
    </main>

    <div id="split-selector-overlay">
        <div class="modal-card">
            <h3>Choose Second Game</h3>
            <div id="split-list" class="split-grid"></div>
            <button onclick="document.getElementById('split-selector-overlay').style.display='none'" style="width:100%; background:none; border:none; color:var(--dim); margin-top:20px; cursor:pointer">Cancel</button>
        </div>
    </div>

    <div id="modal-overlay">
        <div class="modal-card">
            <h3>Add New Game</h3>
            <input type="text" id="mName" placeholder="Name">
            <input type="text" id="mUrl" placeholder="URL">
            <input type="text" id="mIcon" placeholder="Icon URL | Optional">
            <button onclick="saveGame()" style="width:100%; padding:14px; background:#fff; color:#000; border:none; border-radius:10px; font-weight:bold; cursor:pointer; margin-top:10px">Add to Library</button>
            <button onclick="closeModal()" style="width:100%; background:none; border:none; color:var(--dim); margin-top:10px; cursor:pointer">Cancel</button>
        </div>
    </div>

    <div id="edit-overlay">
        <div class="modal-card">
            <h3>Edit Game</h3>
            <input type="text" id="eName" placeholder="Name">
            <input type="text" id="eIcon" placeholder="Icon URL">
            <input type="hidden" id="eIdx">
            <button onclick="updateGame()" style="width:100%; padding:14px; background:#fff; color:#000; border:none; border-radius:10px; font-weight:bold; cursor:pointer; margin-top:10px">Save Changes</button>
            <button onclick="document.getElementById('edit-overlay').style.display='none'" style="width:100%; background:none; border:none; color:var(--dim); margin-top:10px; cursor:pointer">Cancel</button>
        </div>
    </div>

    <div id="settings-overlay" onclick="if(event.target == this) toggleSettings()">
        <div class="modal-card">
            <h2>Select Theme</h2>
            <div class="theme-grid">
                <div class="theme-btn" onclick="setTheme('oled')" style="background:#000;">OLED</div>
                <div class="theme-btn" onclick="setTheme('graphite')" style="background:#25282c;">Graphite</div>
                <div class="theme-btn" onclick="setTheme('snow')" style="background:#fff; color:#000; border:1px solid #ccc">Snow</div>
                <div class="theme-btn" onclick="setTheme('ocean')" style="background:linear-gradient(135deg, #005f73, #0a9396);">Ocean</div>
                <div class="theme-btn" onclick="setTheme('sunset')" style="background:linear-gradient(135deg, #ae2012, #ee9b00);">Sunset</div>
                <div class="theme-btn" onclick="setTheme('midnight')" style="background:linear-gradient(135deg, #24243e, #302b63);">Midnight</div>
                <div class="theme-btn" onclick="setTheme('frost')" style="background:linear-gradient(135deg, #80deea, #e0f7fa); color:#006064">Frost</div>
                <div class="theme-btn" onclick="setTheme('lava')" style="background:linear-gradient(135deg, #800000, #ff4e00);">Lava</div>
                <div class="theme-btn" onclick="setTheme('emerald')" style="background:linear-gradient(135deg, #1b4d3e, #2ecc71);">Emerald</div>
                <div class="theme-btn" onclick="setTheme('grape')" style="background:linear-gradient(135deg, #4b0082, #9b30ff);">Grape</div>
            </div>
            <button onclick="wipeData()" style="width:100%; background:#ff4757; color:white; border:none; padding:12px; border-radius:10px; cursor:pointer; font-weight:bold">Wipe Data</button>
        </div>
    </div>

    <div id="player-view">
        <div class="player-controls">
            <div class="exit-btn" onclick="closePlayer()">‚Üê Exit</div>
            <div class="split-btn" id="split-btn" onclick="openSplitSelector()">Split View</div>
        </div>
        <div class="frames-container">
            <iframe id="game-frame"></iframe>
            <iframe id="game-frame-2"></iframe>
        </div>
    </div>

    <script>
        const KEY = 'gc_final_v13';
        let games = JSON.parse(localStorage.getItem(KEY)) || [];
        let currentTab = 'home';
        let isSplit = false;

        window.addEventListener('load', () => {
            setTimeout(() => {
                const boot = document.getElementById('boot-screen');
                boot.style.opacity = '0';
                setTimeout(() => boot.style.display = 'none', 500);
            }, 2500);
        });

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
            document.getElementById('date').textContent = now.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
        }
        setInterval(updateClock, 1000); updateClock();

        function getIconUrl(game) {
            let dUrl = game.url.startsWith('http') ? game.url : 'https://' + game.url;
            let domain = "web"; try { domain = new URL(dUrl).hostname; } catch(e) {}
            return game.icon || `https://www.google.com/s2/favicons?sz=128&domain=${domain}`;
        }

        function render() {
            const grid = document.getElementById('game-grid');
            const query = document.getElementById('searchBox').value.toLowerCase();
            grid.innerHTML = '';
            
            let list = currentTab === 'home' ? games : games.filter(g => g.fav);
            list.forEach((game, idx) => {
                if (!game.name.toLowerCase().includes(query)) return;
                let dUrl = game.url.startsWith('http') ? game.url : 'https://' + game.url;
                const icon = getIconUrl(game);
                
                grid.innerHTML += `
                    <div class="game-card">
                        <div class="icon-wrapper" onclick="play('${dUrl}')">
                            <img src="${icon}" class="game-icon-sq" onerror="this.src='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/svgs/solid/gamepad.svg'">
                        </div>
                        <strong onclick="play('${dUrl}')">${game.name}</strong>
                        <div class="card-actions">
                            <i class="fa-solid fa-heart" style="color:${game.fav ? '#ff4757' : 'var(--dim)'}" onclick="toggleFav(${idx}); event.stopPropagation();"></i>
                            <i class="fa-solid fa-pen-to-square" onclick="openEdit(${idx}); event.stopPropagation();"></i>
                            <i class="fa-solid fa-trash" onclick="deleteGame(${idx}); event.stopPropagation();"></i>
                        </div>
                    </div>`;
            });
        }

        function openSplitSelector() {
            if (isSplit) { toggleSplit(null); return; }
            const listDiv = document.getElementById('split-list');
            listDiv.innerHTML = '';
            games.forEach(game => {
                let dUrl = game.url.startsWith('http') ? game.url : 'https://' + game.url;
                listDiv.innerHTML += `
                    <div class="split-choice" onclick="toggleSplit('${dUrl}')">
                        <img src="${getIconUrl(game)}">
                        <span>${game.name}</span>
                    </div>`;
            });
            document.getElementById('split-selector-overlay').style.display = 'flex';
        }

        function toggleSplit(url) {
            const f2 = document.getElementById('game-frame-2');
            document.getElementById('split-selector-overlay').style.display = 'none';
            if(!isSplit && url) {
                f2.src = url; f2.style.display = 'block';
                document.getElementById('split-btn').innerText = "Single View";
                isSplit = true;
            } else {
                f2.src = ''; f2.style.display = 'none';
                document.getElementById('split-btn').innerText = "Split View";
                isSplit = false;
            }
        }

        function saveGame() {
            const n = document.getElementById('mName').value;
            const u = document.getElementById('mUrl').value;
            const i = document.getElementById('mIcon').value;
            if (n && u) {
                games.push({ name: n, url: u, icon: i, fav: false });
                localStorage.setItem(KEY, JSON.stringify(games));
                document.getElementById('mName').value = '';
                document.getElementById('mUrl').value = '';
                document.getElementById('mIcon').value = '';
                closeModal(); render();
            }
        }

        function toggleFav(idx) { games[idx].fav = !games[idx].fav; localStorage.setItem(KEY, JSON.stringify(games)); render(); }
        function deleteGame(idx) { if(confirm('Delete?')) { games.splice(idx, 1); localStorage.setItem(KEY, JSON.stringify(games)); render(); } }
        function openEdit(idx) {
            const g = games[idx];
            document.getElementById('eName').value = g.name; document.getElementById('eIcon').value = g.icon || '';
            document.getElementById('eIdx').value = idx;
            document.getElementById('edit-overlay').style.display = 'flex';
        }
        function updateGame() {
            const idx = document.getElementById('eIdx').value;
            games[idx].name = document.getElementById('eName').value;
            games[idx].icon = document.getElementById('eIcon').value;
            localStorage.setItem(KEY, JSON.stringify(games));
            document.getElementById('edit-overlay').style.display = 'none';
            render();
        }
        function switchTab(t, el) {
            currentTab = t;
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
            document.getElementById('view-title').innerText = t === 'home' ? 'Me' : 'Favorites';
            render();
        }
        function play(url) { document.getElementById('game-frame').src = url; document.getElementById('player-view').style.display = 'flex'; }
        function closePlayer() { 
            document.getElementById('game-frame').src = ''; document.getElementById('game-frame-2').src = '';
            document.getElementById('game-frame-2').style.display = 'none';
            document.getElementById('split-btn').innerText = "Split View";
            isSplit = false; document.getElementById('player-view').style.display = 'none'; 
        }
        function toggleSettings() { const s = document.getElementById('settings-overlay'); s.style.display = (s.style.display === 'flex' ? 'none' : 'flex'); }
        function openModal() { document.getElementById('modal-overlay').style.display='flex'; }
        function closeModal() { document.getElementById('modal-overlay').style.display='none'; }
        function setTheme(t) { document.body.className = 'theme-' + t; localStorage.setItem('gc_theme', t); }
        function wipeData() { if(confirm('Wipe?')) { localStorage.removeItem(KEY); games = []; render(); } }

        setTheme(localStorage.getItem('gc_theme') || 'oled');
        render();
    </script>
</body>
</html>
